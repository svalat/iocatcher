digraph IOCATCHER
{
	//Some fonts
	fontname = "Bitstream Vera Sans"
	fontsize = 8
	
	//configure node
	node [
		fontname = "Bitstream Vera Sans"
		fontsize = 8
		shape = "record"
	]
	
	//configure edge
	edge [
		arrowtail = "empty"
		dir=back
	]

	//legend
	subgraph cluster_legend {
		label = "Legend"

		Class [
			label = "{Class|\l|\l}"
		]

		Hub [
			label = "Hub"
			shape = ellipse
		]
	}

	//classes
	subgraph cluster_server {
		label = "Server"

		Server [
			label = "{Server|\l|\l}"
		]

		TcpServer [
			label = "{TcpServer|\l|\l}"
		]

		Config [
			label = "{Config|\l|\l}"
		]

		ServerStats [
			label = "{ServerStats|\l|\l}"
		]
	}

	subgraph cluster_server_hooks {
		label = "Server hooks"

		ServerHook [
			label = "ServerHook"
			shape = ellipse
		]

		HookObjectWrite [
			label = "{HookObjectWrite|\l|\l}"
		]

		HookObjectRead [
			label = "{HookObjectRead|\l|\l}"
		]

		HookObjectCreate [
			label = "{HookObjectCreate|\l|\l}"
		]

		HookObjectCow [
			label = "{HookObjectCow|\l|\l}"
		]

		HookRangeRegister [
			label = "{HookRangeRegister|\l|\l}"
		]

		HookRangeUnregister [
			label = "{HookRangeUnregister|\l|\l}"
		]

		HookFlush [
			label = "{HookFlush|\l|\l}"
		]

		HookPingPong [
			label = "{HookPingPong|\l|\l}"
		]
	}

	subgraph cluster_object_handling {
		label = "Server objet handling"

		Container [
			label = "{Container|\l|\l}"
		]

		Object [
			label = "{Object|\l|\l}"
		]

		StorageBackend [
			label = "{StorageBackend|\l|\l}"
		]

		StorageBackendMero [
			label = "{StorageBackendMero|\l|\l}"
		]

		ConsistencyTracker [
			label = "{ConsistencyTracker|\l|\l}"
		]

		ConsistencyRange [
			label = "{ConsistencyRange|\l|\l}"
		]

		ObjectSegment [
			label = "{ObjectSegment|\l|\l}"
		]

		MemoryBackend [
			label = "{MemoryBackend|\l|\l}"
		]

		MemoryBackendMalloc [
			label = "{MemoryBackendMalloc|\l|\l}"
		]

		MemoryBackendNvdimm [
			label = "{MemoryBackendNvdimm|\l|\l}"
		]

		MemoryBackendCache [
			label = "{MemoryBackendCache|\l|\l}"
		]

		MemoryBackendRoundRobin [
			label = "{MemoryBackendRoundRobin|\l|\l}"
		]

		ObjectSegmentMemory [
			label = "{ObjectSegmentMemory|\l|\l}"
		]

	}

	Backends [
		label = "Backends"
		shape = ellipse
	]

	subgraph cluster_libfabric_handling {
		label = "Libfabric wrapper"

		LibfabricConnection [
			label = "{LibfabricConnection|\l|\l}"
		]

		LibfabricDomain [
			label = "{LibfabricDomain|\l|\l}"
		]

		ClientRegistry [
			label = "{ClientRegistry|\l|\l}"
		]

		Hook [
			label = "{Hook|\l|\l}"
		]

		LibfabricHandler [
			label = "LibfabricHandler"
			shape = ellipse
		]
	}

	subgraph cluster_client {
		label = "Client"

		TcpClient [
			label = "{TcpClient|\l|\l}"
		]

		ioc_client_t [
			label = "{ioc_client_t|\l|\l}"
		]
	}

	subgraph cluster_tasks {
		label = "Worker tasks"

		IOTaskHub [
			label = "IOTaskHub"
			shape = ellipse
		]

		TaskDeferredOps [
			label = "{TaskDeferredOps|\l|\l}"
		]

		TaskObjectCow [
			label = "{TaskObjectCow|\l|\l}"
		]

		TaskObjectFlush [
			label = "{TaskObjectFlush|\l|\l}"
		]

		TaskObjectWriteEager [
			label = "{TaskObjectWriteEager|\l|\l}"
		]

		TaskObjectReadEager [
			label = "{TaskObjectReadEager|\l|\l}"
		]

		TaskObjectReadWriteRdma [
			label = "{TaskObjectReadWriteRdma|\l|\l}"
		]
	}

	HubContainer [
		label = "HubContainer"
		shape = ellipse
	]

	HubContainerForHooks [
		label = "HubContainerForHooks"
		shape = ellipse
	]

	HubTask [
		label = "HubTask"
		shape = ellipse
	]

	subgraph cluster_worker {
		label = "Worker implementation"

		IORange [
			label = "{IORange|\l|\l}"
		]

		IORanges [
			label = "{IORanges|\l|\l}"
		]

		ObjectRange [
			label = "{ObjectRange|\l|\l}"
		]

		ObjectRanges [
			label = "{ObjectRanges|\l|\l}"
		]

		Task [
			label = "{Task|\l|\l}"
		]

		IOTask [
			label = "{IOTask|\l|\l}"
		]

		TaskRunner [
			label = "{TaskRunner|\l|\l}"
		]

		TaskScheduler [
			label = "{TaskScheduler|\l|\l}"
		]

		Worker [
			label = "{Worker|\l|\l}"
		]

		WorkerManager [
			label = "{WorkerManager|\l|\l}"
		]
	}

	//inheritance links
	ServerHook -> HookFlush
	ServerHook -> HookObjectCow
	ServerHook -> HookObjectCreate
	ServerHook -> HookObjectRead
	ServerHook -> HookObjectWrite
	ServerHook -> HookRangeRegister
	ServerHook -> HookRangeUnregister
	ServerHook -> HookPingPong
	Hook -> ServerHook
	StorageBackend -> StorageBackendMero
	MemoryBackend -> MemoryBackendMalloc
	MemoryBackend -> MemoryBackendNvdimm
	MemoryBackend -> MemoryBackendCache
	MemoryBackend -> MemoryBackendRoundRobin
	IOTaskHub -> TaskDeferredOps
	IOTaskHub -> TaskObjectCow
	IOTaskHub -> TaskObjectFlush
	IOTaskHub -> TaskObjectReadEager
	IOTaskHub -> TaskObjectWriteEager
	IOTaskHub -> TaskObjectReadWriteRdma
	IOTask -> IOTaskHub
	Task -> IOTask

	//composition
	LibfabricHandler -> LibfabricDomain[arrowtail=diamond]
	LibfabricHandler -> LibfabricConnection[arrowtail=diamond]
	Server -> Config[arrowtail=odiamond]
	Server -> Container[arrowtail=diamond]
	Server -> TcpServer[arrowtail=diamond]
	Server -> LibfabricHandler[arrowtail=diamond]
	Server -> ServerStats[arrowtail=diamond]
	Server -> Backends[arrowtail=diamond]
	Server -> TaskRunner[arrowtail=diamond]
	Backends -> StorageBackend[arrowtail=diamond]
	Backends -> MemoryBackend[arrowtail=diamond]
	LibfabricConnection -> ClientRegistry[arrowtail=diamond]
	LibfabricConnection -> LibfabricDomain[arrowtail=odiamond]
	LibfabricConnection -> Hook[arrowtail=diamond]
	Container -> Object[arrowtail=diamond]
	Container -> StorageBackend[arrowtail=odiamond]
	Container -> MemoryBackend[arrowtail=odiamond]
	Object -> ObjectSegment[arrowtail=diamond]
	Object -> ConsistencyTracker[arrowtail=diamond]
	Object -> StorageBackend[arrowtail=odiamond]
	Object -> MemoryBackend[arrowtail=odiamond]
	ObjectSegment -> ObjectSegmentMemory[arrowtail=diamond]
	ObjectSegmentMemory -> MemoryBackend[arrowtail=odiamond]
	ConsistencyTracker -> ConsistencyRange[arrowtail=diamond]
	ioc_client_t -> TcpClient[arrowtail=diamond]
	ioc_client_t -> LibfabricDomain[arrowtail=diamond]
	ioc_client_t -> LibfabricConnection[arrowtail=diamond]
	HookFlush -> HubContainerForHooks[arrowtail=odiamond]
	HookFlush -> HubTask[arrowtail=nonde]
	HookObjectCreate -> HubContainerForHooks[arrowtail=odiamond]
	HookObjectCow -> HubContainerForHooks[arrowtail=odiamond]
	HookObjectCow -> HubTask[arrowtail=nonde]
	HookObjectRead -> HubContainerForHooks[arrowtail=odiamond]
	HookObjectRead -> HubTask[arrowtail=nonde]
	HookObjectWrite -> HubContainerForHooks[arrowtail=odiamond]
	HookObjectWrite -> HubTask[arrowtail=nonde]
	HookObjectRead -> ServerStats[arrowtail=odiamond]
	HookObjectWrite -> ServerStats[arrowtail=odiamond]
	IORanges -> IORange[arrowtail=diamond]
	ObjectRange -> ObjectId[arrowtail=diamond]
	ObjectRange -> IORanges[arrowtail=diamond]
	ObjectRanges -> ObjectRange[arrowtail=diamond]
	WorkerManager -> Worker[arrowtail=diamond]
	TaskScheduler -> IOTask[arrowtail=diamond]
	TaskRunner -> WorkerManager[arrowtail=diamond]
	TaskRunner -> TaskScheduler[arrowtail=diamond]
	Worker -> Task[arrowtail=diamond]
	IOTask -> IORanges[arrowtail=diamond]
	IOTask -> ObjectRanges[arrowtail=diamond]
	TaskObjectCow -> HubContainer[arrowtail=odiamond]
	TaskObjectFlush -> HubContainer[arrowtail=odiamond]
	TaskObjectReadEager -> HubContainer[arrowtail=odiamond]
	TaskObjectWriteEager -> HubContainer[arrowtail=odiamond]
	TaskObjectReadWriteRdma -> HubContainer[arrowtail=odiamond]
	HubContainer  -> Container[arrowtail=odiamond]
	HubContainerForHooks  -> Container[arrowtail=odiamond]
	HubTask -> IOTaskHub[arrowtail=nonde]
}
